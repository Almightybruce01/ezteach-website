<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sign In — EZTeach</title>
  <link rel="icon" type="image/png" href="logo.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
    .login-page { min-height: 100vh; display: flex; flex-direction: column; }
    .login-header { padding: 24px 0; border-bottom: 1px solid var(--border); }
    .login-main { flex: 1; display: flex; align-items: center; justify-content: center; padding: 48px 24px; }
    .login-card {
      width: 100%; max-width: 420px;
      padding: 40px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    .login-card .logo { justify-content: center; margin-bottom: 24px; }
    .login-card .logo-img { width: 56px; height: 56px; }
    .login-card h1 { font-size: 1.5rem; text-align: center; margin-bottom: 8px; }
    .login-card .sub { text-align: center; color: var(--text-muted); margin-bottom: 28px; font-size: 0.9375rem; }
    .login-form label { display: block; font-size: 0.875rem; font-weight: 600; margin-bottom: 8px; }
    .login-form input {
      width: 100%; padding: 14px 16px; font-family: var(--font-sans); font-size: 1rem;
      border: 1px solid var(--border); border-radius: var(--radius-sm); margin-bottom: 20px;
    }
    .login-form input:focus { outline: none; border-color: var(--accent); }
    .login-form .btn { width: 100%; padding: 16px; margin-top: 8px; }
    .login-form .error { color: #dc2626; font-size: 0.875rem; margin-bottom: 16px; }
    .login-form .back { display: block; text-align: center; margin-top: 20px; color: var(--accent); text-decoration: none; font-weight: 500; }
    .login-form .back:hover { text-decoration: underline; }
    .login-form .loading { opacity: 0.7; pointer-events: none; }
  </style>
</head>
<body class="login-page">
  <div class="noise"></div>
  <header class="login-header">
    <div class="container">
      <a href="index.html" class="logo">
        <img src="logo.png" alt="EZTeach" class="logo-img">
        <span class="logo-text">EZTeach</span>
      </a>
    </div>
  </header>
  <main class="login-main">
    <div class="login-card">
      <a href="index.html" class="logo">
        <img src="logo.png" alt="EZTeach" class="logo-img">
        <span class="logo-text">EZTeach</span>
      </a>
      <h1>Sign in</h1>
      <p class="sub">Use the same account as the EZTeach app.</p>
      <form class="login-form" id="login-form">
        <div id="login-error" class="error" style="display:none;"></div>
        <label for="email">Email</label>
        <input type="email" id="email" name="email" required placeholder="you@school.edu" autocomplete="email">
        <label for="password">Password</label>
        <input type="password" id="password" name="password" required placeholder="••••••••" autocomplete="current-password">
        <button type="submit" class="btn btn-primary" id="login-btn">Sign in</button>
      </form>
      <a href="index.html" class="back">← Back to home</a>
    </div>
  </main>
  <script src="firebase-config.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
  <script>
    (function () {
      var form = document.getElementById('login-form');
      var errEl = document.getElementById('login-error');
      var btn = document.getElementById('login-btn');

      function showError(msg) {
        errEl.textContent = msg || 'Sign-in failed. Check email and password.';
        errEl.style.display = 'block';
      }
      function hideError() {
        errEl.textContent = '';
        errEl.style.display = 'none';
      }

      form.addEventListener('submit', function (e) {
        e.preventDefault();
        hideError();
        var email = document.getElementById('email').value.trim();
        var password = document.getElementById('password').value;
        if (!email || !password) { showError('Enter email and password.'); return; }

        var config = window.APP_FIREBASE_CONFIG;
        if (!config || !config.apiKey || config.apiKey === 'YOUR_WEB_API_KEY') {
          showError('Firebase web config not set. Add your config in firebase-config.js.');
          return;
        }

        if (typeof firebase === 'undefined') {
          showError('Firebase SDK failed to load.');
          return;
        }

        if (!firebase.apps.length) firebase.initializeApp(config);
        btn.disabled = true;
        form.classList.add('loading');

        firebase.auth().signInWithEmailAndPassword(email, password)
          .then(function () {
            window.location.href = 'dashboard.html';
          })
          .catch(function (err) {
            btn.disabled = false;
            form.classList.remove('loading');
            showError(err.message || 'Sign-in failed.');
          });
      });
    })();
  </script>
</body>
</html>
